package com.brainz.wokhei.server;import com.brainz.wokhei.AdminAuthenticator;import com.brainz.wokhei.client.common.LoginInfo;import com.brainz.wokhei.client.common.LoginService;import com.google.appengine.api.users.User;import com.google.appengine.api.users.UserService;import com.google.appengine.api.users.UserServiceFactory;import com.google.gwt.user.server.rpc.RemoteServiceServlet;/** * @author matteocantarelli * */public class LoginServiceImpl extends RemoteServiceServlet implements LoginService {	/**	 * 	 */	private static final long serialVersionUID = 6500886547305552063L;	public synchronized LoginInfo login(String requestUri) {		UserService userService = UserServiceFactory.getUserService();		User user = userService.getCurrentUser();		LoginInfo loginInfo = new LoginInfo();		if (user != null) {			loginInfo.setLoggedIn(true);			loginInfo.setEmailAddress(user.getEmail());			loginInfo.setNickname(user.getNickname());			loginInfo.setLogoutUrl(userService.createLogoutURL(requestUri));			loginInfo.setIsAdmin(AdminAuthenticator.isAdmin(user));		} else {			loginInfo.setLoggedIn(false);			loginInfo.setLoginUrl(userService.createLoginURL(requestUri));		}		return loginInfo;	}}